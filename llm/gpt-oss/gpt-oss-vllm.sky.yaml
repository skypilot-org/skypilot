resources:
  accelerators: {H100:1, H200:1}
  disk_size: 512 
  ports: 8000

envs:
  MODEL_NAME: openai/gpt-oss-20b

setup: |
  sudo apt-get update
  sudo apt-get install -y python3-dev build-essential
  uv venv --python 3.12 --seed
  source .venv/bin/activate
  uv pip install --pre vllm==0.10.1+gptoss \
    --extra-index-url https://wheels.vllm.ai/gpt-oss/ \
    --extra-index-url https://download.pytorch.org/whl/nightly/cu128 \
    --index-strategy unsafe-best-match
  uv pip install hf_xet openai==1.99.1
  hf download $MODEL_NAME

run: |
  source .venv/bin/activate
  vllm serve $MODEL_NAME \
    --host 0.0.0.0 \
    --port 8000 \
    --trust-remote-code \

service:
  replica_policy:
    min_replicas: 1
    max_replicas: 3
    target_qps_per_replica: 5.0
    upscale_delay_seconds: 300
    downscale_delay_seconds: 600
  readiness_probe: /v1/models
