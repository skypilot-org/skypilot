name: bert-large-squad

resources:
  accelerators: V100:8
  options:
    - {cloud: aws}
    - {cloud: gcp}
    - {cloud: azure, accelerators: V100-32GB:8}

workdir: ./examples/benchmark/transformers_qa

setup: |
  pip3 install "$(echo ~/.sky/sky_wheels/sky_callback-*.whl)";
  pip3 install -r requirements.txt

run: |
  python run_qa.py \
  --model_name_or_path bert-large-uncased \
  --dataset_name squad_v2 \
  --do_train \
  --do_eval \
  --per_device_train_batch_size 4 \
  --learning_rate 3e-5 \
  --num_train_epochs 2 \
  --max_seq_length 384 \
  --doc_stride 128 \
  --output_dir /tmp/debug_squad/ \
  --overwrite_output_dir
