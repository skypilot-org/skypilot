# å¿«é€Ÿå¼€å§‹

import { Tab, Tabs } from '@rspress/core/theme';

åªéœ€å‡ åˆ†é’Ÿå³å¯å¯åŠ¨å¹¶è¿è¡Œ AIO Sandboxã€‚

## å…ˆå†³æ¡ä»¶

- ç³»ç»Ÿä¸Šå·²å®‰è£… [Docker](https://www.docker.com/get-started/)
- è‡³å°‘ 2GB å¯ç”¨å†…å­˜

## å®‰è£…

### é€‰é¡¹ 1ï¼šä½¿ç”¨ Docker è¿è¡Œï¼ˆæ¨èï¼‰

```bash
# æ‹‰å–å¹¶è¿è¡Œæœ€æ–°ç‰ˆæœ¬
docker run --security-opt seccomp=unconfined --rm -it -p 8080:8080 ghcr.io/agent-infra/sandbox:latest
```

### é€‰é¡¹ 2ï¼šä¸­å›½å¤§é™†ç”¨æˆ·

ä½¿ç”¨æˆ‘ä»¬çš„ä¸­å›½é•œåƒä»¥è·å¾—æ›´å¿«çš„ä¸‹è½½é€Ÿåº¦ï¼š

```bash
docker run --security-opt seccomp=unconfined --rm -it -p 8080:8080 enterprise-public-cn-beijing.cr.volces.com/vefaas-public/all-in-one-sandbox:latest
```

> å¦‚æœç«¯å£ 8080 è¢«å ç”¨ï¼Œæ˜ å°„åˆ°ä¸åŒçš„ç«¯å£ï¼š

```bash
docker run --security-opt seccomp=unconfined --rm -it -p 3000:8080 ghcr.io/agent-infra/sandbox:latest
# ç„¶åé€šè¿‡ http://localhost:3000 è®¿é—®
```

## æ¬¢è¿

è¿è¡Œ Docker å‘½ä»¤åï¼Œæ‚¨å°†çœ‹åˆ° AIO Sandbox ASCII æ ‡å¿—ï¼š

```bash
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘    â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â–ˆâ–ˆâ•—
â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—
â•šâ•â•  â•šâ•â•â•šâ•â• â•šâ•â•â•â•â•â•     â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•

ğŸš€ AIO(All-in-One) ä»£ç†æ²™ç›’ç¯å¢ƒ
ğŸ“¦ é•œåƒç‰ˆæœ¬ï¼š1.0.0.93
ğŸŒˆ ä»ªè¡¨æ¿ï¼šhttp://localhost:8080/index.html
ğŸ”Œ MCPï¼šhttp://localhost:8080/mcp
ğŸ“š æ–‡æ¡£ï¼šhttp://localhost:8080/v1/docs
```

## 1. å®‰è£… SDK

<Tabs>
  <Tab label="Python">

```python
pip install agent-sandbox
```

  </Tab>
  <Tab label="TypeScript">

```ts
npm install @agent-infra/sandbox
```

  </Tab>
</Tabs>

## 2. é…ç½®å®¢æˆ·ç«¯

<Tabs>
  <Tab label="Python">

```python
from agent_sandbox import Sandbox

client = Sandbox(base_url="http://localhost:8080")
```

  </Tab>
</Tabs>


## 3. ä¸æ²™ç›’äº¤äº’

é€šè¿‡ `file`ã€`shell`ã€`browser`ã€`code execute` ä¸æ²™ç›’äº¤äº’ã€‚

### æ‰§è¡Œ Shell

<Tabs>
  <Tab label="Python">

```python
shell_res = client.shell.exec_command(command="ls -la")
print(shell_res.data.output) # /home/gem
```

  </Tab>
  <Tab label="Curl">

```bash
curl -X 'POST' \
  'http://127.0.0.1:8080/v1/shell/exec' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "command": "ls -la"
}'
```

  </Tab>
</Tabs>

### æ–‡ä»¶

<Tabs>
  <Tab label="Python">

```python
file_res = client.file.read_file(file="/home/gem/.bashrc")
print(file_res.data.content) # export TERM=xterm-256color
```

  </Tab>
  <Tab label="Curl">

```bash
curl -X 'POST' \
  'http://127.0.0.1:8080/v1/file/read' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "file": "/home/gem/.bashrc"
}'
```

  </Tab>
</Tabs>

### æµè§ˆå™¨

#### æˆªå›¾

<Tabs>
  <Tab label="Python">

```python
screenshot = client.browser.screenshot()
print(screenshot)
```

  </Tab>
  <Tab label="Curl">

```bash
curl -X 'GET' \
  'http://127.0.0.1:8080/v1/browser/screenshot' \
  -H 'accept: image/png'
```

  </Tab>
</Tabs>

#### GUI æ“ä½œ

<Tabs>
  <Tab label="Python">

```python
action_res = client.browser.execute_action_actions_post(
    request=Action_MoveTo(x=100, y=100)
)
print(action_res)
```

  </Tab>
  <Tab label="Curl">

```bash
curl -X 'POST' \
  'http://127.0.0.1:8080/v1/browser/actions' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "action_type": "MOVE_TO",
  "x": 100,
  "y": 100
}'
```

  </Tab>
</Tabs>

> æ›´å¤š `action_type` è¯¦æƒ…å¯ä»¥åœ¨[æµè§ˆå™¨](/guide/basic/browser)ä¸­æ‰¾åˆ°ã€‚

#### ä½¿ç”¨ CDP è¿æ¥åˆ°æµè§ˆå™¨

<Tabs>
  <Tab label="Python">

```python
from playwright.sync_api import sync_playwright

browser_info = client.browser.get_info()
cdp_url = browser_info.data.cdp_url
playwright = sync_playwright().start()
browser = playwright.chromium.connect_over_cdp(cdp_url)
```

  </Tab>
  <Tab label="Curl">

```bash
curl -X 'GET' \
  'http://127.0.0.1:8080/v1/browser/info' \
  -H 'accept: application/json'
```

  </Tab>
</Tabs>

## ç¤ºä¾‹

å°†ç½‘é¡µè½¬æ¢ä¸ºå¸¦æœ‰åµŒå…¥ base64 æˆªå›¾çš„ Markdownï¼š

![](/images/example.png)

<Tabs>
  <Tab label="Python">

```python
import asyncio
import base64
from playwright.async_api import async_playwright
from agent_sandbox import Sandbox


async def site_to_markdown():
    # åˆå§‹åŒ–æ²™ç›’å®¢æˆ·ç«¯
    c = Sandbox(base_url="http://localhost:8080")
    home_dir = c.sandbox.get_context().home_dir

    # æµè§ˆå™¨ï¼šè‡ªåŠ¨åŒ–ä¸‹è½½ html
    async with async_playwright() as p:
        browser_info = c.browser.get_info().data
        page = await (await p.chromium.connect_over_cdp(browser_info.cdp_url)).new_page(
            viewport={
                "width": browser_info.viewport.width,
                "height": browser_info.viewport.height,
            }
        )
        await page.goto("https://sandbox.agent-infra.com/", wait_until="networkidle")
        html = await page.content()
        screenshot_b64 = base64.b64encode(
            await page.screenshot(full_page=False, type='png')
        ).decode('utf-8')

    # Jupyterï¼šåœ¨æ²™ç›’ä¸­è¿è¡Œä»£ç å°† html è½¬æ¢ä¸º markdown
    c.jupyter.execute_code(
        code=f"""
from markdownify import markdownify
html = '''{html}'''
screenshot_b64 = "{screenshot_b64}"

md = f"{{markdownify(html)}}\\n\\n![Screenshot](data:image/png;base64,{{screenshot_b64}})"

with open('{home_dir}/site.md', 'w') as f:
    f.write(md)

print("å®Œæˆï¼")
"""
    )

    # Bashï¼šæ‰§è¡Œå‘½ä»¤åˆ—å‡ºæ²™ç›’ä¸­çš„æ–‡ä»¶
    list_result = c.shell.exec_command(command=f"ls -lh {home_dir}")
    print(f"\næ²™ç›’ä¸»ç›®å½•ä¸­çš„æ–‡ä»¶ï¼š\n{list_result.data.output}")

    open("./output.md", "w").write(
        c.file.read_file(file=f"{home_dir}/site.md").data.content
    )

    return "./output.md"


if __name__ == "__main__":
    # è¿è¡Œå¼‚æ­¥å‡½æ•°
    result = asyncio.run(site_to_markdown())
    print(f"\nMarkdown æ–‡ä»¶ä¿å­˜åœ¨ï¼š{result}")
```

  </Tab>
</Tabs>

## è®¿é—®ç‚¹

è¿è¡Œåï¼Œæ‚¨å¯ä»¥è®¿é—®ä¸åŒçš„ç•Œé¢ï¼š

| æœåŠ¡ | URL | æè¿° |
|---------|-----|-------------|
| **API æ–‡æ¡£** | `http://localhost:8080/v1/docs` | OpenAPI æ–‡æ¡£ |
| **ä»ªè¡¨æ¿** | `http://localhost:8080/index.html` | ä»ªè¡¨æ¿ |
| **VNC æµè§ˆå™¨** | `http://localhost:8080/vnc/index.html?autoconnect=true` | å¸¦æµè§ˆå™¨çš„è¿œç¨‹æ¡Œé¢ |
| **ç»ˆç«¯** | `http://localhost:8080/terminal` | ç»ˆç«¯äº¤äº’ |
| **Code Server** | `http://localhost:8080/code-server/` | VSCode Server |
| **MCP æœåŠ¡å™¨** | `http://localhost:8080/mcp` | æ¨¡å‹ä¸Šä¸‹æ–‡åè®®æœåŠ¡å™¨ |
| **Jupyter** | `http://localhost:8080/jupyter` | VSCode Server |


## è·å–å¸®åŠ©

- æµè§ˆ[ç¤ºä¾‹](/examples/)è·å–å·¥ä½œä»£ç ç¤ºä¾‹
- æŸ¥çœ‹ [API æ–‡æ¡£](/api/)äº†è§£é›†æˆè¯¦æƒ…
