<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 420">
  <defs>
    <style>
      .job-group-box { fill: #f5f5f5; stroke: #666; stroke-width: 2; rx: 10; }
      .task-box { stroke-width: 2; rx: 6; }
      .trainer { fill: #e3f2fd; stroke: #1976d2; }
      .rollout { fill: #fff3e0; stroke: #f57c00; }
      .reward { fill: #f3e5f5; stroke: #7b1fa2; }
      .replay { fill: #e8f5e9; stroke: #388e3c; }
      .data { fill: #fce4ec; stroke: #c2185b; }
      .label { font-family: Arial, sans-serif; font-size: 13px; fill: #333; }
      .title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; fill: #333; }
      .group-title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #444; }
      .arrow { stroke: #666; stroke-width: 1.5; fill: none; }
      .arrow-head { fill: #666; }
      .node-label { font-family: Arial, sans-serif; font-size: 10px; fill: #666; font-style: italic; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" class="arrow-head"/>
    </marker>
  </defs>

  <!-- Job Group Container -->
  <rect x="20" y="20" width="660" height="380" class="job-group-box"/>
  <text x="40" y="50" class="group-title">Job Group: rlhf-training</text>

  <!-- PPO Trainer (center, main component) -->
  <rect x="260" y="160" width="180" height="80" class="task-box trainer"/>
  <text x="350" y="195" class="title" text-anchor="middle">ppo-trainer</text>
  <text x="350" y="215" class="node-label" text-anchor="middle">2x A100 GPU nodes</text>
  <text x="350" y="228" class="node-label" text-anchor="middle">(training loop)</text>

  <!-- Rollout Server (top left) -->
  <rect x="40" y="80" width="160" height="70" class="task-box rollout"/>
  <text x="120" y="110" class="title" text-anchor="middle">rollout-server</text>
  <text x="120" y="128" class="node-label" text-anchor="middle">2x A100 GPU nodes</text>
  <text x="120" y="141" class="node-label" text-anchor="middle">(generate responses)</text>

  <!-- Reward Server (top right) -->
  <rect x="500" y="80" width="160" height="70" class="task-box reward"/>
  <text x="580" y="110" class="title" text-anchor="middle">reward-server</text>
  <text x="580" y="128" class="node-label" text-anchor="middle">8+ CPUs</text>
  <text x="580" y="141" class="node-label" text-anchor="middle">(compute rewards)</text>

  <!-- Replay Buffer (bottom center) -->
  <rect x="260" y="300" width="180" height="70" class="task-box replay"/>
  <text x="350" y="330" class="title" text-anchor="middle">replay-buffer</text>
  <text x="350" y="348" class="node-label" text-anchor="middle">32+ GB memory</text>
  <text x="350" y="361" class="node-label" text-anchor="middle">(experience storage)</text>

  <!-- Data Server (bottom left) -->
  <rect x="40" y="300" width="160" height="70" class="task-box data"/>
  <text x="120" y="330" class="title" text-anchor="middle">data-server</text>
  <text x="120" y="348" class="node-label" text-anchor="middle">4+ CPUs</text>
  <text x="120" y="361" class="node-label" text-anchor="middle">(prompts &amp; data)</text>

  <!-- Arrows -->
  <!-- Rollout to Trainer -->
  <path d="M 200 130 Q 230 160 260 180" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="205" y="145" class="node-label">rollouts</text>

  <!-- Trainer to Rollout (policy updates) -->
  <path d="M 270 170 Q 220 140 200 120" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="210" y="175" class="node-label">policy</text>

  <!-- Reward to Trainer -->
  <path d="M 500 130 Q 470 160 440 180" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="480" y="145" class="node-label">rewards</text>

  <!-- Trainer to Reward (samples) -->
  <path d="M 430 170 Q 480 140 500 120" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="465" y="175" class="node-label">samples</text>

  <!-- Trainer to Replay Buffer -->
  <path d="M 350 240 L 350 298" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="358" y="275" class="node-label">experiences</text>

  <!-- Replay Buffer to Trainer -->
  <path d="M 320 300 L 320 242" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="270" y="275" class="node-label">batches</text>

  <!-- Data Server to Trainer -->
  <path d="M 200 320 L 258 250" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="200" y="280" class="node-label">prompts</text>

  <!-- Data Server to Rollout -->
  <path d="M 120 298 L 120 152" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="128" y="230" class="node-label">data</text>
</svg>
